# Svelte client

Svelte client is a very thin wrapper of [svelte query](https://tanstack.com/query/latest).

```ts copy filename="client.ts"
import { createSvelteClient } from '@ptsq/svelte-client';
import type { BaseRouter } from './server';

const client = createSvelteClient<BaseRouter>({
  url: 'http://localhost:4000/ptsq',
});
```

## Query

```tsx copy filename="Component.svelte"
<script lang="ts">
  const response = client.test.createQuery({
    name: /* string */ 'John',
  });
</script>

{#if $response.isFetching}
	<p>Loading...</p>
{:else if $reponse.data}
	<p>{$response.data /* string */}</p>
{:else}
	<p>{$response.error.message /* PtsqClientError */}</p>
{/if}
```

## Mutation

```tsx copy filename="Component.svelte"
<script lang="ts">
  const response = client.test.createMutation();
</script>

<button on:click={() =>
  $reponse.mutate({
    name: /* string */ 'John'
  })
}>
  Mutate
</button>

{#if $response.isPending}
	<p>Loading...</p>
{:else if $reponse.data}
	<p>{$response.data /* string */}</p>
{:else}
	<p>{$response.error.message /* PtsqClientError */}</p>
{/if}
```

## Infinite query

the `createInfiniteQuery` is exposed only if your server accepts `pageParam` property with any type. That means the input has to extends `{ pageParam: any }`.

```ts copy filename="server.ts"
resolver
  .args(
    Type.Object({
      pageParam: Type.Integer(),
    }),
  )
  .output(
    Type.Object({
      data: Type.Array(Type.String()),
      nextCursor: Type.Integer(),
    }),
  )
  .query(({ input }) => {
    return {
      data: data.slice(
        input.pageParam * pageSize,
        (input.pageParam + 1) * pageSize,
      ),
      nextCursor: input.pageParam + 1,
    };
  });
```

```tsx copy filename="Component.svelte"
<script lang="ts">
  const response = client.test.createInfiniteQuery(
    {}, // pageParam is automatically passed by the infinite query, you should not have it in the input
    {
      initialPageParam: 0,
      getNextPageParam: (lastPage) => lastPage.nextCursor,
    }
  );
</script>

<div>
  <p>data: {JSON.stringify($response.data)}</p>
  <button onClick={() => $response.fetchNextPage()}>load next</button>
</div>
```
