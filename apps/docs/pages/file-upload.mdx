# File upload

```ts filename="server.ts"
import { createServer, expressAdapter, ExpressAdapterContext } from '@schema-rpc/server';
import express from 'express';
import { z } from 'zod';

const app = express();

const createContext = ({ req, res }: ExpressAdapterContext) => ({
  req,
  res,
});

const { middleware, resolver, router, serve } = createServer({
  ctx: createContext,
});

const uploadFile = resolver.binary({
  multiple: false,
  resolve: async ({ ctx /* { req: express.Request, res: express.Response } */, input /* { file: File } */ }) => {
    const textContent = await file.text();
    return textContent;
  },
});

const uploadFiles = resolver.binary({
  multiple: true,
  resolve: async ({ ctx /* { req: express.Request, res: express.Response } */, input /* { file: FileList } */ }) => {
    //...
  },
});

const baseRouter = router({
  uploadFile,
});

app.use('/schema-rpc', expressAdapter(serve({ router: baseRouter })));

app.listen(4000);
```

```ts filename="client.ts"
import { createProxyClient } from '@schema-rpc/client';
import { baseRouter } from './schema';

const client = createProxyClient(baseRouter);

const file = new File(['foo'], 'foo.txt', {
  type: 'text/plain',
});

const result = await client.uploadFile.upload({
  file: /* File */ file,
});
```

## DOM lib

DOM library has to be included in `tsconfig.json`

```json filename="tsconfig.json"
{
  "compilerOptions": {
    "lib": [
      // ... other stuff
      "dom" // <-
    ]
    // ... other stuff
  }
}
```
