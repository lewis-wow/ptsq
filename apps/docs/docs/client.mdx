# Client

The client is a Javascript `Proxy` object.
It has only a `noop` function in the proxy and anything else.

```ts
const noop = () => {};
```

But you cannot call the function, because Typescript cast that type of the `Proxy` client into something like `PsqlClient<BaseRouter>`.

## Proprietary client

```ts title="client.ts"
import { createProxyClient } from '@ptsq/client';

/**
 * non introspcted or generated file, just type of server router
 */
import type { BaseRouter } from './server';

const client = createProxyClient<BaseRouter>({
  url: 'http://localhost:4000/ptsq',
});

const result /* string */ = await client.test.query({
  name: /* string */ 'John',
});
```

## Introspected schema

Even if this is not directly the server router schema, it is introspected, the way you define client stays the same, client does not care if the server is in your repository or somewhere remote.

```ts title="client.ts"
import { createProxyClient } from '@ptsq/client';

/**
 * introspected or generated file, no server exposed, ready for open api
 */
import type { RootRouter } from './schema.generated';

const client = createProxyClient<RootRouter>({
  url: 'http://localhost:4000/ptsq',
});

const result /* string */ = await client.test.query({
  name: /* string */ 'John',
});
```

Introspected schema can also has comments with hints what the serialized type is actuall is. So if the response return `DateTime` as a string, then there is a way to describe the `DateTime` scalar on the server, to give hints on the client side.

## Options

```ts
type CreateProxyClientArgs = {
  url: string;
  credentials?: boolean;
  headers?: RequestHeaders | (() => MaybePromise<RequestHeaders>);
};
```

The url is the url of ptsq server e.g. `https://example.com/ptsq/'.
If credentials option is true, then credentials like cookies are sent to the server with every request.
You can also specify headers you want to send such as `Authorization`header and so on.
Headers can be defined as callable funciton, so for example you can get cookies like jwt token in the function that is then passed to`Authorization` header.

```ts title="client.ts"
import { createProxyClient } from '@ptsq/client';
import type { BaseRouter } from './server';

const client = createProxyClient<BaseRouter>({
  url: 'http://localhost:4000/ptsq',
  headers: async () => {
    const jwt = await cookies.get('jwt');

    return {
      Authorization: `Bearer ${jwt}`,
    };
  },
  credentials: true,
});

const result /* string */ = await client.test.query({
  name: /* string */ 'John',
});
```
